@model MagazinFigurineApp.Models.Figurina

<div class="container mt-5">
    <div class="row bg-white shadow-sm rounded p-4">
        @* Coloana Stânga: Imagine *@
        <div class="col-md-6 text-center border-end d-flex align-items-center justify-content-center">
            @if (!string.IsNullOrEmpty(Model.ImagineUrl))
            {
                @* Prioritate 1: Imaginea nouă pe disc *@
                <img src="/images/figurine/@Model.ImagineUrl" class="img-fluid rounded" style="max-height: 500px;"
                     onerror="this.style.display='none'; document.getElementById('backupImg').style.display='block';"
                     alt="@Model.Nume" />

                @* Backup invizibil în caz că URL-ul e greșit *@
                <img id="backupImg" src="/images/default-item.png" class="img-fluid rounded" style="max-height: 500px; display: none;" />
            }
            else if (Model.ImagineFigurina != null && Model.ImagineFigurina.Length > 0)
            {
                @* Prioritate 2: Imaginea veche din Baza de Date *@
                <img src="data:image/jpeg;base64,@Convert.ToBase64String(Model.ImagineFigurina)"
                     class="img-fluid rounded" style="max-height: 500px;" alt="@Model.Nume" />
            }
            else
            {
                @* Fallback *@
                <img src="/images/default-item.png" class="img-fluid rounded" alt="Imagine indisponibilă" />
            }
        </div>

        @* Coloana Dreapta: Info *@
        <div class="col-md-6 ps-md-5">
            <h1 class="display-5 fw-bold">@Model.Nume</h1>
            <h2 class="text-primary my-3">@Model.Pret.ToString("C2")</h2>
            <p class="lead text-muted">@Model.Descriere</p>

            <div class="alert alert-secondary mt-4">
                <strong>SKU:</strong> @Model.SKU | <strong>Stoc:</strong> @Model.Stoc
            </div>

            @if (Model.Stoc > 0)
            {
                <form asp-controller="Cos" asp-action="Adauga" method="post" class="mt-4">
                    <input type="hidden" name="figurinaId" value="@Model.FigurinaID" />
                    <button type="submit" class="btn btn-success btn-lg w-100 shadow">
                        <i class="bi bi-cart-plus me-2"></i> Adaugă în coș
                    </button>
                </form>
            }
            else
            {
                <button class="btn btn-secondary btn-lg w-100 mt-4 disabled">Stoc Epuizat</button>
            }
        </div>
    </div>

    @* Secțiunea de Poveste și Specificații *@
    <div class="row mt-5 mb-5">
        <div class="col-12">
            @if (!string.IsNullOrEmpty(Model.PovestePersonaj))
            {
                <h3 class="border-bottom pb-2">Povestea Personajului</h3>
                <p class="mt-3 text-muted" style="white-space: pre-line;">@Model.PovestePersonaj</p>
            }

            @if (!string.IsNullOrEmpty(Model.DescriereDetaliata))
            {
                <h3 class="border-bottom pb-2 mt-5">Specificații Tehnice</h3>
                <p class="mt-3 text-muted">@Model.DescriereDetaliata</p>
            }
        </div>
    </div>
</div>